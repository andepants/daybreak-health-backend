<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>6</epicId>
    <storyId>3</storyId>
    <title>Self-Pay Rates & Comparison</title>
    <status>ready-for-dev</status>
    <generatedAt>2025-11-30</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/epics.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>parent considering self-pay</asA>
    <iWant>to see transparent self-pay pricing and compare to insurance estimates</iWant>
    <soThat>I can make the best financial decision for my family</soThat>
    <tasks>
      <task id="1" title="Create SelfPayRate Model with Effective Dates" ac="1,8">
        <subtask>Create migration for self_pay_rates table with: id:uuid, session_type:string, base_rate:decimal(8,2), effective_date:date, end_date:date, sliding_scale_available:boolean, package_pricing_available:boolean, description:text, metadata:jsonb</subtask>
        <subtask>Create app/models/self_pay_rate.rb with validations for session_type (intake, individual_therapy, family_therapy), base_rate presence and positive value, effective_date presence</subtask>
        <subtask>Add scope for currently_active rates: where("effective_date &lt;= ? AND (end_date IS NULL OR end_date &gt; ?)", Date.current, Date.current)</subtask>
        <subtask>Add method get_rate_for(session_type, date = Date.current) to return active rate for given session type</subtask>
        <subtask>Add sliding_scale_tiers to metadata JSONB for income-based pricing: [{income_range: "0-25000", discount_percent: 50}, ...]</subtask>
        <subtask>Add package_options to metadata JSONB: [{sessions: 4, total_price: 400, savings: 50, description: "4-session bundle"}]</subtask>
        <subtask>Write model specs for rate lookup, effective date filtering, and metadata parsing</subtask>
      </task>
      <task id="2" title="Create CostComparisonService for Insurance vs Self-Pay Analysis" ac="2,3,6,8">
        <subtask>Create app/services/billing/cost_comparison_service.rb service class</subtask>
        <subtask>Accept session_id in constructor, load session with insurance and child data</subtask>
        <subtask>Method calculate_comparison returns: {insurance_estimate: {...}, self_pay_estimate: {...}, recommendation: string, savings_if_self_pay: decimal|nil}</subtask>
        <subtask>Calculate insurance estimate: if verified, use copay/deductible/coinsurance from InsuranceType fields; if not verified, return nil</subtask>
        <subtask>Calculate self-pay estimate: load active SelfPayRate for individual_therapy session type</subtask>
        <subtask>Implement high_deductible_detection: if deductible_amount - deductible_met &gt; 1000, flag as high deductible scenario</subtask>
        <subtask>Set recommendation logic: if high deductible AND deductible not met AND self_pay &lt; estimated insurance cost, recommend "Self-pay may be more affordable"</subtask>
        <subtask>Calculate savings_if_self_pay: max(0, insurance_estimate - self_pay_rate) when applicable</subtask>
        <subtask>Include session_count_estimate (e.g., 8-12 sessions typical) for total cost projection</subtask>
        <subtask>Write service specs testing various insurance scenarios: verified/high-deductible, verified/low-copay, unverified, self_pay status</subtask>
      </task>
      <task id="3" title="Create CostComparison GraphQL Type" ac="2,8">
        <subtask>Create app/graphql/types/cost_comparison_type.rb GraphQL type</subtask>
        <subtask>Field insurance_estimate: InsuranceEstimateType, null: true (null if insurance not verified)</subtask>
        <subtask>Field self_pay_estimate: SelfPayEstimateType, null: false (always available)</subtask>
        <subtask>Field comparison_table: [ComparisonRowType!], null: false (side-by-side rows)</subtask>
        <subtask>Field recommendation: String, null: true (personalized recommendation based on situation)</subtask>
        <subtask>Field savings_if_self_pay: Float, null: true (positive amount if self-pay cheaper)</subtask>
        <subtask>Field highlight_self_pay: Boolean, null: false (true when self-pay is better option)</subtask>
        <subtask>Write type specs for schema validation</subtask>
      </task>
      <task id="4" title="Create Supporting GraphQL Types for Cost Display" ac="1,4,5,7">
        <subtask>Create app/graphql/types/insurance_estimate_type.rb: fields per_session_cost:String, total_estimated_cost:String, explanation:String, assumption_notes:[String!]</subtask>
        <subtask>Create app/graphql/types/self_pay_estimate_type.rb: fields base_rate:String (e.g., "$50 per session"), total_for_typical_treatment:String, sliding_scale_info:String|null, package_options:[PackageOptionType!]</subtask>
        <subtask>Create app/graphql/types/package_option_type.rb: fields sessions:Int, total_price:String, per_session_cost:String, savings:String, description:String</subtask>
        <subtask>Create app/graphql/types/comparison_row_type.rb: fields label:String, insurance_value:String|null, self_pay_value:String, highlight_self_pay:Boolean</subtask>
        <subtask>Update app/graphql/types/self_pay_option_type.rb to include preview_rate field with actual current rate</subtask>
        <subtask>Write type specs ensuring proper formatting and null handling</subtask>
      </task>
      <task id="5" title="Add costComparison Query to GraphQL Schema" ac="8">
        <subtask>Add field to app/graphql/types/query_type.rb: costComparison(sessionId: ID!): CostComparisonType!</subtask>
        <subtask>Create resolver app/graphql/queries/cost_comparison.rb</subtask>
        <subtask>Validate session exists and belongs to current user (authorization)</subtask>
        <subtask>Call CostComparisonService.new(session_id).calculate_comparison</subtask>
        <subtask>Format results into CostComparisonType structure with currency formatting</subtask>
        <subtask>Handle edge case: insurance not yet entered - show self-pay only with message</subtask>
        <subtask>Write query specs with authorization tests</subtask>
      </task>
      <task id="6" title="Implement Comparison Table Logic" ac="2,3">
        <subtask>In CostComparisonService, generate comparison_rows array with: "Per Session Cost", "Typical Treatment (8-12 sessions)", "Out-of-Pocket Before Deductible Met", "After Deductible Met"</subtask>
        <subtask>For each row, populate insurance_value (from coverage data) and self_pay_value (from SelfPayRate)</subtask>
        <subtask>Set highlight_self_pay: true for rows where self-pay is numerically lower</subtask>
        <subtask>Format all currency values consistently: "$XX.00" or "$XXX.00"</subtask>
        <subtask>Include explanatory notes for insurance estimates: "Based on your verified coverage details" or "Estimate based on typical coverage"</subtask>
        <subtask>Write comparison logic specs with various insurance scenarios</subtask>
      </task>
      <task id="7" title="Add Sliding Scale Information Display" ac="4,7">
        <subtask>In SelfPayEstimateType resolver, check if sliding_scale_available is true on active rate</subtask>
        <subtask>If available, format sliding_scale_info field: "Sliding scale available based on household income. Discounts from 10-50% may apply."</subtask>
        <subtask>Include link/reference to financial assistance application process</subtask>
        <subtask>Do not show actual income tiers or discount percentages in main display (keep simplified)</subtask>
        <subtask>Add note: "Contact us to discuss financial assistance options"</subtask>
        <subtask>Write specs for sliding scale display logic</subtask>
      </task>
      <task id="8" title="Implement Package Pricing Display" ac="5">
        <subtask>In SelfPayEstimateType resolver, load package_options from SelfPayRate metadata</subtask>
        <subtask>Format each package option: sessions count, total_price, per_session_cost (calculated), savings amount, description</subtask>
        <subtask>Sort packages by sessions count ascending (4-session, 8-session, 12-session)</subtask>
        <subtask>Display savings prominently: "Save $X with this package"</subtask>
        <subtask>Include note: "Packages must be purchased upfront and used within 6 months"</subtask>
        <subtask>Write specs for package options display</subtask>
      </task>
      <task id="9" title="Add No Hidden Fees Messaging" ac="6">
        <subtask>In SelfPayEstimateType, add field transparent_pricing_message: String!, always return "No surprise fees. Price shown is what you pay."</subtask>
        <subtask>Add field what_is_included: [String!] listing "50-minute session", "Secure messaging between sessions", "Treatment planning and notes"</subtask>
        <subtask>Add field what_is_not_included: [String!] if applicable (e.g., "Medication management (requires separate psychiatry visit)")</subtask>
        <subtask>Write specs ensuring messaging is always present</subtask>
      </task>
      <task id="10" title="Enable Easy Switching Between Insurance and Self-Pay" ac="9">
        <subtask>Update app/graphql/mutations/insurance/select_self_pay.rb to set verification_status: :self_pay</subtask>
        <subtask>Add mutation switchToInsurance(sessionId: ID!): Session! to revert from self-pay back to insurance verification</subtask>
        <subtask>Ensure costComparison query always shows both options regardless of current selection</subtask>
        <subtask>Add field current_payment_method: String! to OnboardingSessionType (returns "insurance" or "self_pay")</subtask>
        <subtask>Write mutation specs for switching between payment methods</subtask>
      </task>
      <task id="11" title="Seed Database with Initial Self-Pay Rates" ac="1,8">
        <subtask>Create db/seeds/self_pay_rates.rb seed file</subtask>
        <subtask>Seed current rates effective from project start date: individual_therapy: $75, family_therapy: $100, intake_assessment: $150</subtask>
        <subtask>Include sliding_scale_available: true with sample tiers in metadata</subtask>
        <subtask>Include package_options: 4-session bundle ($280, save $20), 8-session bundle ($560, save $40), 12-session bundle ($810, save $90)</subtask>
        <subtask>Set end_date: nil for ongoing rates</subtask>
        <subtask>Add test seeds for expired rates to validate effective date filtering</subtask>
      </task>
      <task id="12" title="Integration with Test Data from contracts.csv" ac="1">
        <subtask>Review docs/test-cases/contracts.csv for service pricing terms</subtask>
        <subtask>Extract individual_therapy and family_therapy pricing from terms JSON column</subtask>
        <subtask>Map contract pricing to SelfPayRate model where applicable</subtask>
        <subtask>Note: contracts.csv represents org-specific sponsored pricing; self-pay rates are separate but should be competitive</subtask>
        <subtask>Document relationship between contract pricing and self-pay rates in comments</subtask>
      </task>
      <task id="13" title="Testing and Validation" ac="all">
        <subtask>Write integration test: parent with verified insurance views cost comparison, sees both estimates side-by-side</subtask>
        <subtask>Write integration test: parent with high-deductible plan sees recommendation to consider self-pay with savings amount</subtask>
        <subtask>Write integration test: parent with unverified insurance sees self-pay estimate only with message to verify insurance</subtask>
        <subtask>Write integration test: parent views package pricing options, sees savings calculations</subtask>
        <subtask>Write integration test: parent switches from insurance to self-pay and back</subtask>
        <subtask>Test edge case: no active SelfPayRate exists (graceful degradation with default messaging)</subtask>
        <subtask>Test currency formatting consistency across all cost displays</subtask>
        <subtask>Test that comparison highlights self-pay when appropriate (high deductible scenarios)</subtask>
        <subtask>Performance test: costComparison query returns in under 500ms</subtask>
      </task>
    </tasks>
  </story>

  <acceptanceCriteria>
    <criterion id="1">Clear self-pay rates per session type displayed (individual therapy, family therapy, intake assessment)</criterion>
    <criterion id="2">Comparison table: insurance estimate vs. self-pay shown side-by-side with line items (per session, typical treatment, before/after deductible)</criterion>
    <criterion id="3">Highlight when self-pay might be cheaper (high deductible plans where deductible not met and self-pay &lt; insurance cost)</criterion>
    <criterion id="4">Sliding scale information if applicable - message indicating income-based discounts available</criterion>
    <criterion id="5">Package pricing options (e.g., 4-session bundle, 8-session bundle) with per-session cost and total savings</criterion>
    <criterion id="6">No hidden fees messaging - transparent pricing statement always displayed</criterion>
    <criterion id="7">Rates competitive and transparent - actual dollar amounts shown, not ranges</criterion>
    <criterion id="8">GraphQL query costComparison(sessionId: ID!): CostComparison! returns full comparison data</criterion>
    <criterion id="9">Easy to switch between insurance and self-pay - mutations available for both directions</criterion>
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/prd.md</path>
        <title>Product Requirements Document</title>
        <section>FR25 - Self-Pay Fallback</section>
        <snippet>FR25: Parents can proceed with self-pay option if insurance fails. Foundation for Story 6.3 cost comparison feature.</snippet>
      </doc>
      <doc>
        <path>docs/prd.md</path>
        <title>Product Requirements Document</title>
        <section>Insurance Processing (FR19-FR25)</section>
        <snippet>Insurance verification and self-pay options are critical to preventing onboarding abandonment. Transparency builds trust.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Document</title>
        <section>Service Pattern</section>
        <snippet>Services in app/services/ namespace. Business logic isolated from GraphQL layer. CostComparisonService follows this pattern.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture Document</title>
        <section>GraphQL Type Pattern</section>
        <snippet>Types in app/graphql/types/ extending BaseObject. Use resolver methods for computed fields. Currency formatting in type layer.</snippet>
      </doc>
      <doc>
        <path>docs/epics.md</path>
        <title>Epic Breakdown</title>
        <section>Epic 6 - Cost Estimation Tool</section>
        <snippet>P1 priority epic providing transparent cost information including insurance estimates, self-pay rates, deductible tracking, and payment options.</snippet>
      </doc>
      <doc>
        <path>docs/epics.md</path>
        <title>Epic Breakdown</title>
        <section>Story 6.1 - Cost Calculation Engine</section>
        <snippet>Prerequisite: Flexible engine to calculate therapy session costs. Uses SessionRate model and contracts.csv test data for pricing terms.</snippet>
      </doc>
      <doc>
        <path>docs/epics.md</path>
        <title>Epic Breakdown</title>
        <section>Story 6.2 - Insurance Cost Estimation</section>
        <snippet>Prerequisite: Insurance-based cost estimates using verified coverage details (copay, coinsurance, deductible). Uses insurance_coverages.csv test data.</snippet>
      </doc>
      <doc>
        <path>docs/test-cases/contracts.csv</path>
        <title>Contracts Test Data</title>
        <section>Service Pricing Terms</section>
        <snippet>Contains pricing for individual_therapy, family_therapy services. JSON terms column includes pre/post cap pricing rules.</snippet>
      </doc>
      <doc>
        <path>docs/test-cases/insurance_coverages.csv</path>
        <title>Insurance Coverage Test Data</title>
        <section>Patient Coverage Details</section>
        <snippet>Coverage data for testing cost estimates: member_id, copay amounts, deductibles, eligibility status.</snippet>
      </doc>
    </docs>
    <code>
      <artifact>
        <path>app/models/insurance.rb</path>
        <kind>model</kind>
        <symbol>Insurance</symbol>
        <lines>1-430</lines>
        <reason>Insurance model with eligibility verification data. Used by CostComparisonService to get copay_amount, deductible_amount, deductible_met, coinsurance_percentage for insurance cost estimates.</reason>
      </artifact>
      <artifact>
        <path>app/models/onboarding_session.rb</path>
        <kind>model</kind>
        <symbol>OnboardingSession</symbol>
        <lines>1-100</lines>
        <reason>Core session model. CostComparisonService loads session to access associated insurance and child data for personalized cost estimates.</reason>
      </artifact>
      <artifact>
        <path>app/graphql/types/insurance_type.rb</path>
        <kind>graphql-type</kind>
        <symbol>Types::InsuranceType</symbol>
        <lines>1-204</lines>
        <reason>InsuranceType exposes copay_amount, deductible_amount, deductible_met, coinsurance_percentage fields used for cost comparison calculations.</reason>
      </artifact>
      <artifact>
        <path>app/graphql/types/self_pay_option_type.rb</path>
        <kind>graphql-type</kind>
        <symbol>Types::SelfPayOptionType</symbol>
        <lines>1-20</lines>
        <reason>Existing self-pay preview type. Will be enhanced with actual rate data from SelfPayRate model for preview_rate field.</reason>
      </artifact>
      <artifact>
        <path>app/graphql/types/coverage_details_type.rb</path>
        <kind>graphql-type</kind>
        <symbol>Types::CoverageDetailsType</symbol>
        <lines>1-26</lines>
        <reason>Coverage details type with formatted copay, deductible, services. Pattern to follow for InsuranceEstimateType formatting.</reason>
      </artifact>
      <artifact>
        <path>app/services/insurance_services/coverage_formatter.rb</path>
        <kind>service</kind>
        <symbol>InsuranceServices::CoverageFormatter</symbol>
        <lines>1-168</lines>
        <reason>Formats insurance coverage data for display. Pattern for currency formatting in CostComparisonService: format_copay, format_deductible methods.</reason>
      </artifact>
      <artifact>
        <path>app/graphql/types/query_type.rb</path>
        <kind>graphql-type</kind>
        <symbol>Types::QueryType</symbol>
        <lines>1-50</lines>
        <reason>Root query type. Add costComparison field here returning CostComparisonType for given session ID.</reason>
      </artifact>
    </code>
    <dependencies>
      <ruby>
        <gem name="rails" version="~> 7.2.3">Rails framework with Active Record for SelfPayRate model</gem>
        <gem name="graphql" version="~> 2.2">GraphQL server for costComparison query and types</gem>
        <gem name="rspec-rails" version="~> 6.1">Testing framework</gem>
        <gem name="factory_bot_rails" version="~> 6.4">Test fixtures for SelfPayRate</gem>
      </ruby>
      <env>
        <var name="DEFAULT_SELF_PAY_RATE">Optional: Default self-pay rate if no active rate in database (fallback)</var>
        <var name="FINANCIAL_ASSISTANCE_URL">Optional: URL for financial assistance application</var>
      </env>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint>SelfPayRate model with effective_date and end_date for rate versioning - rates can change over time</constraint>
    <constraint>Currency formatting consistent across all displays: "$XX.00" format</constraint>
    <constraint>CostComparisonService in app/services/billing/ namespace following service pattern</constraint>
    <constraint>GraphQL types in app/graphql/types/ namespace with proper null handling</constraint>
    <constraint>Session-scoped authorization: users can only query costs for their own sessions</constraint>
    <constraint>Graceful handling when insurance not verified: show self-pay only with message to verify insurance</constraint>
    <constraint>High deductible detection threshold: deductible remaining &gt; $1000 triggers recommendation</constraint>
    <constraint>Package pricing calculations must be accurate: total_price / sessions = per_session_cost shown</constraint>
    <constraint>Sliding scale details kept general in main display - detailed tiers shown only on request/financial assistance flow</constraint>
    <constraint>Comparison logic must handle all insurance states: verified, unverified, self_pay, failed</constraint>
    <constraint>No hidden fees messaging required on all self-pay displays for transparency</constraint>
    <constraint>Test data integration: reference contracts.csv for realistic pricing, insurance_coverages.csv for coverage scenarios</constraint>
  </constraints>

  <interfaces>
    <interface>
      <name>costComparison Query</name>
      <kind>GraphQL Query</kind>
      <signature>query CostComparison($sessionId: ID!) { costComparison(sessionId: $sessionId) { insuranceEstimate { perSessionCost totalEstimatedCost explanation } selfPayEstimate { baseRate totalForTypicalTreatment slidingScaleInfo packageOptions { sessions totalPrice perSessionCost savings } } comparisonTable { label insuranceValue selfPayValue highlightSelfPay } recommendation savingsIfSelfPay highlightSelfPay } }</signature>
      <path>app/graphql/types/query_type.rb (field), app/graphql/queries/cost_comparison.rb (resolver)</path>
    </interface>
    <interface>
      <name>SelfPayRate Model</name>
      <kind>ActiveRecord Model</kind>
      <signature>class SelfPayRate &lt; ApplicationRecord; scope :currently_active; def self.get_rate_for(session_type, date = Date.current); end</signature>
      <path>app/models/self_pay_rate.rb</path>
    </interface>
    <interface>
      <name>Billing::CostComparisonService</name>
      <kind>Service</kind>
      <signature>def initialize(session_id); def calculate_comparison returns { insurance_estimate: {...}, self_pay_estimate: {...}, comparison_table: [...], recommendation: string, savings_if_self_pay: decimal|nil, highlight_self_pay: boolean }</signature>
      <path>app/services/billing/cost_comparison_service.rb</path>
    </interface>
    <interface>
      <name>CostComparisonType</name>
      <kind>GraphQL Type</kind>
      <signature>field :insurance_estimate, InsuranceEstimateType, null: true; field :self_pay_estimate, SelfPayEstimateType, null: false; field :comparison_table, [ComparisonRowType!], null: false; field :recommendation, String, null: true; field :savings_if_self_pay, Float, null: true; field :highlight_self_pay, Boolean, null: false</signature>
      <path>app/graphql/types/cost_comparison_type.rb</path>
    </interface>
    <interface>
      <name>selectSelfPay Mutation</name>
      <kind>GraphQL Mutation</kind>
      <signature>mutation SelectSelfPay($sessionId: ID!) { selectSelfPay(input: { sessionId: $sessionId }) { session { id insurance { verificationStatus } } } }</signature>
      <path>app/graphql/mutations/insurance/select_self_pay.rb (existing, updated)</path>
    </interface>
    <interface>
      <name>switchToInsurance Mutation</name>
      <kind>GraphQL Mutation</kind>
      <signature>mutation SwitchToInsurance($sessionId: ID!) { switchToInsurance(input: { sessionId: $sessionId }) { session { id insurance { verificationStatus } } } }</signature>
      <path>app/graphql/mutations/insurance/switch_to_insurance.rb (new)</path>
    </interface>
  </interfaces>

  <tests>
    <standards>RSpec with Rails conventions. Factory Bot for test data. Integration tests for full cost comparison flows. Test currency formatting accuracy. Use insurance_coverages.csv and contracts.csv fixtures.</standards>
    <locations>
      <location>spec/models/self_pay_rate_spec.rb - Model validations, scopes, rate lookup by session type and date</location>
      <location>spec/services/billing/cost_comparison_service_spec.rb - Service logic for all insurance scenarios</location>
      <location>spec/graphql/queries/cost_comparison_spec.rb - Query resolver tests with authorization</location>
      <location>spec/graphql/types/cost_comparison_type_spec.rb - Type schema validation</location>
      <location>spec/integration/cost_comparison_flow_spec.rb - End-to-end cost comparison scenarios</location>
      <location>spec/factories/self_pay_rates.rb - Factory for test rate data</location>
    </locations>
    <ideas>
      <idea ac="1">Test SelfPayRate.get_rate_for returns correct rate for each session type</idea>
      <idea ac="1">Test rate versioning: expired rates not returned, future rates not returned, current rates returned</idea>
      <idea ac="2">Test comparison table includes all required rows: per session, typical treatment, deductible scenarios</idea>
      <idea ac="2">Test insurance_value formatting matches self_pay_value formatting style</idea>
      <idea ac="3">Test high deductible detection: deductible_remaining &gt; 1000 triggers highlight_self_pay: true</idea>
      <idea ac="3">Test low deductible scenario: deductible_remaining &lt; 100 does NOT highlight self-pay</idea>
      <idea ac="3">Test savings_if_self_pay calculation: positive when self-pay cheaper, nil when insurance cheaper</idea>
      <idea ac="4">Test sliding_scale_info displays when sliding_scale_available: true on rate</idea>
      <idea ac="4">Test no sliding scale message when sliding_scale_available: false</idea>
      <idea ac="5">Test package_options sorted by sessions count ascending</idea>
      <idea ac="5">Test package savings calculation: (base_rate * sessions) - package_total_price</idea>
      <idea ac="5">Test package per_session_cost: package_total_price / sessions</idea>
      <idea ac="6">Test transparent_pricing_message always present on self-pay estimate</idea>
      <idea ac="7">Test all currency values formatted as "$XX.00" consistently</idea>
      <idea ac="8">Test costComparison query with verified insurance: returns both estimates</idea>
      <idea ac="8">Test costComparison query with unverified insurance: returns self-pay only with message</idea>
      <idea ac="8">Test authorization: cannot query costs for other users' sessions</idea>
      <idea ac="9">Test selectSelfPay mutation updates verification_status to self_pay</idea>
      <idea ac="9">Test switchToInsurance mutation reverts to appropriate insurance status</idea>
      <idea ac="all">Integration test: verified insurance + high deductible shows self-pay recommendation</idea>
      <idea ac="all">Integration test: verified insurance + low copay shows insurance as better option</idea>
      <idea ac="all">Integration test: no active SelfPayRate gracefully shows default message</idea>
      <idea ac="all">Performance test: costComparison query completes in under 500ms</idea>
    </ideas>
  </tests>
</story-context>
