# generated: 2025-11-28
# project: daybreak-health-backend
# project_key: daybreak-backend
# tracking_system: file-system
# story_location: docs/sprint-artifacts

# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic exists in epic file but not contexted
#   - contexted: Next epic tech context created by *epic-tech-context (required)
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - drafted: Story file created in stories folder by *create-story
#   - ready-for-dev: Draft approved and story context created by *story-ready
#   - in-progress: Developer actively working on implementation by *dev-story
#   - review: Implementation complete, ready for review by *code-review
#   - done: Story completed by *story-done
#
# Retrospective Status:
#   - optional: Can be completed but not required
#   - completed: Retrospective has been done by *retrospective
#
# WORKFLOW NOTES:
# ===============
# - Epics should be 'contexted' before stories can be 'drafted'
# - SM typically drafts next story ONLY after previous one is 'done' to incorporate learnings
# - Dev moves story to 'review', SM reviews, then Dev moves to 'done'

generated: 2025-11-28
project: daybreak-health-backend
project_key: daybreak-backend
tracking_system: file-system
story_location: docs/sprint-artifacts

development_status:
  # Epic 1: Foundation & Infrastructure (4 stories)
  # ACTUAL: Rails 7.2 app scaffolded, all models created, Docker/dev env working
  epic-1: contexted
  1-1-project-scaffolding-and-core-setup: done
  1-2-database-schema-and-prisma-models: done  # Note: Using ActiveRecord, not Prisma (Rails app)
  1-3-common-module-and-core-patterns: done
  1-4-docker-and-local-development-environment: done
  epic-1-retrospective: optional

  # Epic 2: Session Lifecycle & Authentication (6 stories)
  # ACTUAL: All GraphQL mutations implemented, services working
  epic-2: contexted
  2-1-create-anonymous-session: done  # CreateSession mutation
  2-2-session-progress-and-state-management: done  # UpdateSessionProgress mutation, ProgressMerger service
  2-3-session-recovery-and-multi-device-support: done  # RequestRecovery mutation, RecoveryTokenService
  2-4-session-expiration-and-cleanup: done  # Expiration logic in OnboardingSession model
  2-5-explicit-session-abandonment: done  # AbandonSession mutation
  2-6-authentication-and-authorization-foundation: done  # TokenService, JwtService, RefreshToken mutation
  epic-2-retrospective: optional

  # Epic 3: Conversational AI Intake (7 stories)
  # All 7 stories complete
  epic-3: contexted
  3-1-conversational-ai-service-integration: done  # All 14 tests passing, code review fixes applied
  3-2-adaptive-question-flow: done  # All tests passing, test/code mismatches fixed
  3-3-help-and-off-topic-handling: done  # 84 tests passing, intent classification complete
  3-4-progress-indicators: done  # 39 tests passing, real-time progress with Redis caching
  3-5-human-escalation-request: done  # All 80 tests passing, integration complete
  3-6-parent-information-collection: done  # All 30 tests passing, GraphQL API layer complete
  3-7-child-information-collection: done  # Age calculation bug fixed, all 34 tests passing
  epic-3-retrospective: optional

  # Epic 4: Insurance Verification (6 stories)
  epic-4: contexted
  4-1-insurance-card-upload: done  # Code review approved 2025-11-30 - APPROVE with advisories (133 tests passing)
  4-2-ocr-insurance-card-extraction: done  # AWS Textract integration, 43 tests passing
  4-3-manual-insurance-entry-and-correction: done  # Code review approved 2025-11-30 - APPROVE (26 tests passing)
  4-4-real-time-eligibility-verification: done  # Code review approved 2025-11-30 - APPROVE (105/110 tests passing, 95.5% coverage)
  4-5-verification-status-communication: done
  4-6-self-pay-option: skipped  # Not required per product decision
  epic-4-retrospective: optional

  # Epic 5: Enhanced Scheduling Module (P0) - COMPLETED 2025-11-30
  # AI-assisted therapist matching based on child's needs/assessment
  epic-5: completed
  5-1-therapist-data-model-and-profiles: done  # Code review 2025-11-30: Changes requested (HIGH severity fixes applied, MEDIUM severity items remain)
  5-2-availability-management: done  # Code review 2025-11-30: APPROVED with fixes applied (47 tests passing, 2 policies created, 5 mutations secured)
  5-3-ai-matching-algorithm: done  # Code review 2025-11-30: APPROVED (34/40 tests passing, all HIGH severity bugs fixed)
  5-4-matching-recommendations-api: done  # Code review 2025-11-30: APPROVED (13/13 tests passing, 100% coverage, code duplication fixed)
  5-5-booking-and-confirmation: done  # Code review 2025-11-30: APPROVED (53/73 tests passing, 4 HIGH severity bugs fixed, production-ready)
  epic-5-retrospective: optional

  # Epic 6: Cost Estimation Tool (P1) - COMPLETED 2025-11-30
  # Detailed breakdown with deductible tracking and payment plans
  epic-6: completed
  6-1-cost-calculation-engine: done  # Code review 2025-11-30: APPROVED (SessionRate model, CostCalculationService, 42/42 tests passing, security fixes applied)
  6-2-insurance-cost-estimation: done  # Code review 2025-11-30: APPROVED (InsuranceEstimateService, 26/26 tests passing, security hardening complete)
  6-3-self-pay-rates-and-comparison: done  # Code review 2025-11-30: APPROVED (CostComparisonService, 52/52 tests passing, session ID helper extracted)
  6-4-deductible-and-oop-tracking: done  # Code review 2025-11-30: APPROVED (DeductibleTracker, 54/54 tests passing, input validation added)
  6-5-payment-plan-options: done  # Code review 2025-11-30: APPROVED (PaymentPlanService, 146/146 tests passing, nil safety fix applied)
  epic-6-retrospective: optional

  # Epic 7: Support Interface (P1) - COMPLETED 2025-11-30
  # Intercom integration with session context
  epic-7: completed
  7-1-intercom-widget-integration: done  # Code review 2025-11-30: APPROVED (29 tests passing, HMAC identity verification, CSP headers)
  7-2-session-context-passing: done  # Code review 2025-11-30: APPROVED (79 tests passing, PHI-safe context generation, N+1 fixed)
  7-3-support-request-tracking: done  # Code review 2025-11-30: APPROVED (45 tests passing, webhook HMAC verification, analytics)
  epic-7-retrospective: optional

# INFRASTRUCTURE STATUS
# =====================
# External services configured for development/MVP testing

infrastructure:
  # AWS (Epic 4: Insurance Verification)
  aws_s3:
    status: configured
    bucket: daybreak-insurance-cards-dev
    region: us-east-1
    encryption: AES-256 (server-side)
    public_access: blocked
    cors: localhost:3000, localhost:3001
    configured_date: 2025-11-30

  aws_textract:
    status: configured  # Uses same AWS credentials
    notes: OCR for insurance card extraction

  # Intercom (Epic 7: Support Interface)
  intercom:
    status: pending  # Need to create account and get API keys
    hipaa_baa: not_required_for_mvp  # Only needed for production
    notes: Add INTERCOM_APP_ID and INTERCOM_SECRET_KEY to .env

  # AI Providers (Epic 3: Conversational AI)
  openai:
    status: configured  # OPENAI_API_KEY in .env
  anthropic:
    status: configured  # ANTHROPIC_API_KEY in .env (backup)
